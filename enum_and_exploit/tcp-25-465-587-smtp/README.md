# Simple Mail Transfer Protocol _(SMTP)_ enumeration and exploitation
* [Initial enumeration](#initial-enumeration)
* [Brute-forcing usernames](#brute-forcing-usernames)

## Initial enumeration
```bash
nmap -vv -p 25,465,587 -sT --script=+smtp* <ip>
```

## Brute-forcing usernames
- Brute-force usernames:
```bash
smtp-user-enum -U /Users/kali/SecLists/Usernames/top-usernames-shortlist.txt -t <ip>
smtp-user-enum -M RCPT -U /Users/kali/SecLists/Usernames/top-usernames-shortlist.txt -t <ip>
smtp-user-enum -M EXPN -U /Users/kali/SecLists/Usernames/top-usernames-shortlist.txt -t <ip>

smtp-user-enum -U /Users/kali/SecLists/Usernames/xato-net-10-million-usernames.txt -t <ip>
smtp-user-enum -M RCPT -U /Users/kali/SecLists/Usernames/xato-net-10-million-usernames.txt -t <ip>
smtp-user-enum -M EXPN -U /Users/kali/SecLists/Usernames/xato-net-10-million-usernames.txt -t <ip>
```
- Check if a single user exists:
```bash
smtp-user-enum -u <username> -t <ip>
```
